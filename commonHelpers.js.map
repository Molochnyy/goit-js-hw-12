{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n\nfunction showLoader() {\n    const loader = document.querySelector('.loader');\n    loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n    const loader = document.querySelector('.loader');\n    loader.style.display = 'none';\n}\n\nexport async function searchPhotos(query, page = 1) {\n    showLoader();\n\n    const searchParams = new URLSearchParams({\n        key: '44066114-c3ff57994064ae6e377a0cfb1',\n        q: query.trim(),\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n        page: page,\n    });\n\n    const url = `https://pixabay.com/api/?${searchParams}`;\n\n    try {\n        const response = await axios.get(url);\n        totalHits = response.data.totalHits;\n        return response.data;\n    } catch (error) {\n        console.error('Error:', error);\n        throw error;\n    } finally {\n        hideLoader();\n    }\n}\n\nexport function resetPage() {\n    currentPage = 1;\n}\n\nexport function incrementPage() {\n    currentPage += 1;\n}\n\nexport function getCurrentPage() {\n    return currentPage;\n}\n\nexport function setCurrentQuery(query) {\n    currentQuery = query;\n}\n\nexport function getCurrentQuery() {\n    return currentQuery;\n}\n\nexport function getTotalHits() {\n    return totalHits;\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const listImg = document.querySelector('.list');\nconst lightbox = new SimpleLightbox('.item-list-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nexport const markupInterface = data => {\n  const markup = data.hits\n    .map(hit => {\n      return `\n      <li class=\"item-list\">\n        <a href=\"${hit.largeImageURL}\" class=\"item-list-link\">\n          <img class=\"item-list-img\" src=\"${hit.webformatURL}\" alt=\"${hit.tags}\">\n        </a>\n        <div class='markup-info'>\n          <div class=\"item-list-info-text\">\n            <h3 class=\"item-list-title\">Likes</h3>\n            <p class=\"item-list-text\">${hit.likes}</p>\n          </div>\n          <div class=\"item-list-info-text\">\n            <h3 class=\"item-list-title\">Views</h3>\n            <p class=\"item-list-text\">${hit.views}</p>\n          </div>\n          <div class=\"item-list-info-text\">\n            <h3 class=\"item-list-title\">Comments</h3>\n            <p class=\"item-list-text\">${hit.comments}</p>\n          </div>\n          <div class=\"item-list-info-text\">\n            <h3 class=\"item-list-title\">Downloads</h3>\n            <p class=\"item-list-text\">${hit.downloads}</p>\n          </div>\n        </div>\n      </li>\n    `;\n    })\n    .join('');\n\n  listImg.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n};","import {\n    searchPhotos,\n    resetPage,\n    incrementPage,\n    getCurrentPage,\n    setCurrentQuery,\n    getCurrentQuery,\n    getTotalHits,\n} from './js/pixabay-api.js';\nimport { markupInterface, listImg } from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst searchButton = document.querySelector('.searchButton');\nconst loadMoreButton = document.querySelector('.load-more');\n\nconst clearInput = () => {\n    const input = document.querySelector('.input');\n    input.value = '';\n};\n\nfunction hideLoader() {\n    const loader = document.querySelector('.loader');\n    loader.style.display = 'none';\n}\n\nsearchButton.addEventListener('click', async event => {\n    event.preventDefault();\n\n    const input = document.querySelector('.input');\n\n    if (input.value.trim() === '') {\n        iziToast.error({\n            title: 'Error',\n            message:\n                'The search field cannot be empty! Please enter the search query!',\n        });\n        return;\n    }\n\n    resetPage();\n    setCurrentQuery(input.value);\n    listImg.innerHTML = '';\n    loadMoreButton.style.display = 'none';\n\n    try {\n        const data = await searchPhotos(getCurrentQuery(), getCurrentPage());\n        markupInterface(data);\n\n        if (data.hits.length) {\n            loadMoreButton.style.display = 'block';\n        }\n\n        if (data.totalHits === 0) {\n            iziToast.error({\n                title: 'Error',\n                message:\n                    'Sorry, there was an error when receiving data. Please try again!',\n            });\n        }\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message:\n                'Sorry, there was an error when receiving data. Please try again!',\n        });\n    }\n\n    clearInput();\n});\n\nloadMoreButton.addEventListener('click', async () => {\n    incrementPage();\n\n    try {\n        const data = await searchPhotos(getCurrentQuery(), getCurrentPage());\n        markupInterface(data);\n\n        const totalLoadedImages = document.querySelectorAll('.item-list').length;\n\n        if (totalLoadedImages >= getTotalHits()) {\n            loadMoreButton.style.display = 'none';\n            iziToast.error({\n                title: 'Error',\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n            });\n        }\n\n        const { height: cardHeight } = document\n            .querySelector('.item-list')\n            .getBoundingClientRect();\n\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: 'smooth',\n        });\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message:\n                'Sorry, there was an error when receiving data. Please try again!',\n        });\n    }\n});"],"names":["currentPage","currentQuery","totalHits","showLoader","loader","hideLoader","searchPhotos","query","page","url","response","axios","error","resetPage","incrementPage","getCurrentPage","setCurrentQuery","getCurrentQuery","getTotalHits","listImg","lightbox","SimpleLightbox","markupInterface","data","markup","hit","searchButton","loadMoreButton","clearInput","input","event","iziToast","cardHeight"],"mappings":"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"}